// Generated by CoffeeScript 1.3.3
(function(){var e;e=function(){function e(e,t){t==null&&(t={}),this.fnStack={},this.init(e,t)}return e.prototype.init=function(e,t){var n,r=this;return typeof e=="string"&&(n=document.getElementById(e))&&n.tagName==="IMG"&&(e=n),this._loaded=!1,(this.img=e).addEventListener("load",function(){return r._imageLoaded()})},e.prototype.isReady=function(){return this._loaded},e.prototype._imageLoaded=function(){var e,t,n=this;return this.canvas=document.createElement("canvas"),this.canvas.width=this.width=t=this.img.width,this.canvas.height=this.height=e=this.img.height,this.ctx=this.canvas.getContext("2d"),this.ctx.drawImage(this.img,0,0,t,e),this.data=this.ctx.getImageData(0,0,t,e).data,this.img.addEventListener("click",function(e){return n.imgClick(e)}),this.img.addEventListener("mousemove",function(e){return n.imgMousemove(e)}),this._loaded=!0},e.prototype.colorFromPoint=function(t){var n,r;return n=r=(t.y*this.width+t.x)*4,this.hex=e.rgbToHex(this.rgb=[this.data[n],this.data[n+1],this.data[n+2]])},e.prototype.imgClick=function(e){return this.trigger("click",this.hex,this.rgb)},e.prototype.imgMousemove=function(e){return this.trigger("mousemove",this.colorFromPoint(this.cursor=this._getCursor(e)),this.rgb)},e.prototype._getCursor=function(e){var t;return(t=this._offset)==null&&(this._offset=this._getOffset()),{x:e.clientX-this._offset.x,y:e.clientY-this._offset.y}},e.prototype._getOffset=function(){var e,t,n;t=n=0,e=this.img;while(e.offsetParent)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return this._offset={x:t,y:n}},e.prototype.trigger=function(e){var t,n,r,i,s,o;n=this.fnStack[e],t=Array.prototype.slice.call(arguments,1);if(n!=null){o=[];for(i=0,s=n.length;i<s;i++)r=n[i],o.push(r.apply(this,t));return o}},e.prototype.on=function(e,t){var n;return(this.fnStack[e]=(n=this.fnStack[e])!=null?n:[]).push(t)},e.prototype.off=function(e,t){var n,r,i,s,o,u;n=this.fnStack[e];if(typeof t=="function"?t():void 0){u=[];for(i=s=0,o=n.length;s<o;i=++s)r=n[i],u.push(r===t?n.splice(i,1):void 0);return u}return delete this.fnStack[e]},e}(),e.rgbToHex=function(e){var t,n,r,i,s,o;t=[],r=function(e,n){var r,i;return r=(e-0).toString(16),t.push(i=r.length===1?"0"+r:r)};for(n=s=0,o=e.length;s<o;n=++s)i=e[n],r(i,n);return"#"+t.join("")},e.rgbToHsv=function(e){var t,n,r,i,s,o,u,a,f,l;u=e[0]/255,r=e[1]/255,t=e[2]/255,s=Math.max(u,r,t),o=Math.min(u,r,t),f=s,n=s-o,a=s===0?0:n/s;if(s===o)i=0;else{switch(s){case u:i=(r-t)/n+((l=r<t)!=null?l:{6:0});break;case r:i=(t-u)/n+2;break;case t:i=(u-r)/n+4}i*=60}return[i,a,f]},window.ImageEyeDropper=e}).call(this);